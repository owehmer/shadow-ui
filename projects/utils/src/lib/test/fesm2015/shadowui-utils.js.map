{"version":3,"file":"shadowui-utils.js","sources":["ng://@shadowui/utils/lib/dyn-grid/dyn-grid.directive.ts","ng://@shadowui/utils/lib/dyn-grid/dyn-grid.module.ts"],"sourcesContent":["import {\n  AfterViewInit,\n  ContentChildren,\n  Directive,\n  ElementRef, HostBinding,\n  Input,\n  OnChanges,\n  OnDestroy,\n  QueryList,\n  Renderer2,\n  RendererStyleFlags2,\n  Self,\n  SimpleChanges\n} from '@angular/core';\nimport { BehaviorSubject, combineLatest, Subject } from 'rxjs';\nimport { auditTime, startWith, takeUntil } from 'rxjs/operators';\n\ntype GridDisplayKeys = 'display' | 'grid-gap' | 'grid-template-columns' | 'grid-template-rows';\n\ntype GridDisplay = {\n  [key in GridDisplayKeys]: any;\n};\n\n\n@Directive({\n  selector: '[sdwDynGridChild]'\n})\nexport class SdwDynGridDirective {\n  @HostBinding('style.grid-column-start')\n  get styleColSpan(): string {\n    return this.colSpan ? `span ${this.colSpan}` : undefined;\n  }\n\n  @HostBinding('style.grid-row-start')\n  get styleRowSpan(): string {\n    return this.rowSpan ? `span ${this.rowSpan}` : undefined;\n  }\n\n  @Input() colSpan: number;\n  @Input() rowSpan: number;\n\n  constructor(public parent: SdwDynGridContainerDirective) {\n  }\n\n}\n\n\n@Directive({\n  selector: '[sdwDynGridContainer]'\n})\nexport class SdwDynGridContainerDirective implements AfterViewInit, OnChanges, OnDestroy {\n  @Input()\n  get elementRef(): ElementRef<any> {\n    return this._elemRef$.getValue();\n  }\n\n  set elementRef(value: ElementRef<any>) {\n    this._elemRef$.next(value);\n  }\n\n  @Input() gridGap = '5px';\n  @Input() cols: string[] | number;\n  @Input() rows: string[] | number;\n\n  @ContentChildren(SdwDynGridDirective)\n  children: QueryList<SdwDynGridDirective>;\n\n  private _elemRef$ = new BehaviorSubject<ElementRef<HTMLElement>>(undefined);\n  private _prefElemRef: ElementRef<HTMLElement>;\n  private _prefElemStyles: GridDisplay = {\n    display: '',\n    'grid-gap': '',\n    'grid-template-columns': '',\n    'grid-template-rows': ''\n  };\n\n  private _changes$ = new Subject();\n  private _destroyed$ = new Subject();\n\n  constructor(@Self() elemRef: ElementRef<HTMLElement>,\n              private _renderer: Renderer2) {\n    this.elementRef = elemRef;\n  }\n\n  ngAfterViewInit(): void {\n    combineLatest([\n      this._elemRef$,\n      this._changes$.pipe(auditTime(50), startWith(null))\n    ]).pipe(\n      takeUntil(this._destroyed$)\n    ).subscribe(([elemRef]) => {\n      // Reset Element\n      if (this._prefElemRef != null) {\n        Object.keys(this._prefElemStyles).forEach(key => {\n          this._renderer.setStyle(this._prefElemRef.nativeElement, key, this._prefElemStyles[key]);\n        });\n      }\n\n      this._prefElemRef = elemRef;\n\n      if (!elemRef) {\n        return;\n      }\n\n      Object.keys(this._prefElemStyles).forEach(key => {\n        const style = elemRef.nativeElement.style[key];\n        this._prefElemStyles[key] = style;\n      });\n\n      this._calcStyles(elemRef ? elemRef.nativeElement : undefined);\n    });\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this._changes$.next();\n  }\n\n  ngOnDestroy(): void {\n    this._destroyed$.next();\n    this._destroyed$.complete();\n  }\n\n  private _calcStyles(elemRef: HTMLElement) {\n    if (elemRef == null) {\n      return;\n    }\n\n    const cols = this._colAndRowToStringArr(this.cols);\n    const rows = this._colAndRowToStringArr(this.rows);\n    this._renderer.setStyle(elemRef, 'display', 'grid');\n    this._renderer.setStyle(elemRef, 'grid-gap', this.gridGap, RendererStyleFlags2.DashCase);\n    this._renderer.setStyle(elemRef, 'grid-template-columns', cols.join(' '), RendererStyleFlags2.DashCase);\n    this._renderer.setStyle(elemRef, 'grid-template-rows', rows.join(' '), RendererStyleFlags2.DashCase);\n  }\n\n  private _colAndRowToStringArr(input: string[] | number) {\n    if (input == null) {\n      return ['1fr'];\n    }\n    if (typeof input === 'number') {\n      return new Array(input).fill('1fr');\n    }\n    return input.map(c => c ? c : '1fr');\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { SdwDynGridContainerDirective, SdwDynGridDirective } from './dyn-grid.directive';\n\n@NgModule({\n  declarations: [SdwDynGridContainerDirective, SdwDynGridDirective],\n  imports: [\n    CommonModule\n  ],\n  exports: [SdwDynGridContainerDirective, SdwDynGridDirective]\n})\nexport class SdwDynGridModule { }\n"],"names":[],"mappings":"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"}