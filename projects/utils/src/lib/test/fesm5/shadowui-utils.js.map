{"version":3,"file":"shadowui-utils.js","sources":["ng://@shadowui/utils/lib/dyn-grid/dyn-grid.directive.ts","ng://@shadowui/utils/lib/dyn-grid/dyn-grid.module.ts"],"sourcesContent":["import {\n  AfterViewInit,\n  ContentChildren,\n  Directive,\n  ElementRef, HostBinding,\n  Input,\n  OnChanges,\n  OnDestroy,\n  QueryList,\n  Renderer2,\n  RendererStyleFlags2,\n  Self,\n  SimpleChanges\n} from '@angular/core';\nimport { BehaviorSubject, combineLatest, Subject } from 'rxjs';\nimport { auditTime, startWith, takeUntil } from 'rxjs/operators';\n\ntype GridDisplayKeys = 'display' | 'grid-gap' | 'grid-template-columns' | 'grid-template-rows';\n\ntype GridDisplay = {\n  [key in GridDisplayKeys]: any;\n};\n\n\n@Directive({\n  selector: '[sdwDynGridChild]'\n})\nexport class SdwDynGridDirective {\n  @HostBinding('style.grid-column-start')\n  get styleColSpan(): string {\n    return this.colSpan ? `span ${this.colSpan}` : undefined;\n  }\n\n  @HostBinding('style.grid-row-start')\n  get styleRowSpan(): string {\n    return this.rowSpan ? `span ${this.rowSpan}` : undefined;\n  }\n\n  @Input() colSpan: number;\n  @Input() rowSpan: number;\n\n  constructor(public parent: SdwDynGridContainerDirective) {\n  }\n\n}\n\n\n@Directive({\n  selector: '[sdwDynGridContainer]'\n})\nexport class SdwDynGridContainerDirective implements AfterViewInit, OnChanges, OnDestroy {\n  @Input()\n  get elementRef(): ElementRef<any> {\n    return this._elemRef$.getValue();\n  }\n\n  set elementRef(value: ElementRef<any>) {\n    this._elemRef$.next(value);\n  }\n\n  @Input() gridGap = '5px';\n  @Input() cols: string[] | number;\n  @Input() rows: string[] | number;\n\n  @ContentChildren(SdwDynGridDirective)\n  children: QueryList<SdwDynGridDirective>;\n\n  private _elemRef$ = new BehaviorSubject<ElementRef<HTMLElement>>(undefined);\n  private _prefElemRef: ElementRef<HTMLElement>;\n  private _prefElemStyles: GridDisplay = {\n    display: '',\n    'grid-gap': '',\n    'grid-template-columns': '',\n    'grid-template-rows': ''\n  };\n\n  private _changes$ = new Subject();\n  private _destroyed$ = new Subject();\n\n  constructor(@Self() elemRef: ElementRef<HTMLElement>,\n              private _renderer: Renderer2) {\n    this.elementRef = elemRef;\n  }\n\n  ngAfterViewInit(): void {\n    combineLatest([\n      this._elemRef$,\n      this._changes$.pipe(auditTime(50), startWith(null))\n    ]).pipe(\n      takeUntil(this._destroyed$)\n    ).subscribe(([elemRef]) => {\n      // Reset Element\n      if (this._prefElemRef != null) {\n        Object.keys(this._prefElemStyles).forEach(key => {\n          this._renderer.setStyle(this._prefElemRef.nativeElement, key, this._prefElemStyles[key]);\n        });\n      }\n\n      this._prefElemRef = elemRef;\n\n      if (!elemRef) {\n        return;\n      }\n\n      Object.keys(this._prefElemStyles).forEach(key => {\n        const style = elemRef.nativeElement.style[key];\n        this._prefElemStyles[key] = style;\n      });\n\n      this._calcStyles(elemRef ? elemRef.nativeElement : undefined);\n    });\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this._changes$.next();\n  }\n\n  ngOnDestroy(): void {\n    this._destroyed$.next();\n    this._destroyed$.complete();\n  }\n\n  private _calcStyles(elemRef: HTMLElement) {\n    if (elemRef == null) {\n      return;\n    }\n\n    const cols = this._colAndRowToStringArr(this.cols);\n    const rows = this._colAndRowToStringArr(this.rows);\n    this._renderer.setStyle(elemRef, 'display', 'grid');\n    this._renderer.setStyle(elemRef, 'grid-gap', this.gridGap, RendererStyleFlags2.DashCase);\n    this._renderer.setStyle(elemRef, 'grid-template-columns', cols.join(' '), RendererStyleFlags2.DashCase);\n    this._renderer.setStyle(elemRef, 'grid-template-rows', rows.join(' '), RendererStyleFlags2.DashCase);\n  }\n\n  private _colAndRowToStringArr(input: string[] | number) {\n    if (input == null) {\n      return ['1fr'];\n    }\n    if (typeof input === 'number') {\n      return new Array(input).fill('1fr');\n    }\n    return input.map(c => c ? c : '1fr');\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { SdwDynGridContainerDirective, SdwDynGridDirective } from './dyn-grid.directive';\n\n@NgModule({\n  declarations: [SdwDynGridContainerDirective, SdwDynGridDirective],\n  imports: [\n    CommonModule\n  ],\n  exports: [SdwDynGridContainerDirective, SdwDynGridDirective]\n})\nexport class SdwDynGridModule { }\n"],"names":[],"mappings":";;;;;;;;;;;IAyCE,6BAAmB,MAAoC;QAApC,WAAM,GAAN,MAAM,CAA8B;KACtD;IAdD,sBACI,6CAAY;;;;QADhB;YAEE,OAAO,IAAI,CAAC,OAAO,GAAG,UAAQ,IAAI,CAAC,OAAS,GAAG,SAAS,CAAC;SAC1D;;;OAAA;IAED,sBACI,6CAAY;;;;QADhB;YAEE,OAAO,IAAI,CAAC,OAAO,GAAG,UAAQ,IAAI,CAAC,OAAS,GAAG,SAAS,CAAC;SAC1D;;;OAAA;;gBAZF,SAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;iBAC9B;;;;gBAe4B,4BAA4B;;;+BAbtD,WAAW,SAAC,yBAAyB;+BAKrC,WAAW,SAAC,sBAAsB;0BAKlC,KAAK;0BACL,KAAK;;IAKR,0BAAC;CApBD,IAoBC;;;IANC,sCAAyB;;IACzB,sCAAyB;;IAEb,qCAA2C;;AAMzD;IAgCE,sCAAoB,OAAgC,EAChC,SAAoB;QAApB,cAAS,GAAT,SAAS,CAAW;QApB/B,YAAO,GAAG,KAAK,CAAC;QAOjB,cAAS,GAAG,IAAI,eAAe,CAA0B,SAAS,CAAC,CAAC;QAEpE,oBAAe,GAAgB;YACrC,OAAO,EAAE,EAAE;YACX,UAAU,EAAE,EAAE;YACd,uBAAuB,EAAE,EAAE;YAC3B,oBAAoB,EAAE,EAAE;SACzB,CAAC;QAEM,cAAS,GAAG,IAAI,OAAO,EAAE,CAAC;QAC1B,gBAAW,GAAG,IAAI,OAAO,EAAE,CAAC;QAIlC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC;KAC3B;IA/BD,sBACI,oDAAU;;;;QADd;YAEE,OAAO,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC;SAClC;;;;;QAED,UAAe,KAAsB;YACnC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC5B;;;OAJA;;;;IA8BD,sDAAe;;;IAAf;QAAA,iBA2BC;QA1BC,aAAa,CAAC;YACZ,IAAI,CAAC,SAAS;YACd,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC;SACpD,CAAC,CAAC,IAAI,CACL,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,CAC5B,CAAC,SAAS;;;;QAAC,UAAC,EAAS;gBAAT,kBAAS,EAAR,eAAO;;YAEnB,IAAI,KAAI,CAAC,YAAY,IAAI,IAAI,EAAE;gBAC7B,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,eAAe,CAAC,CAAC,OAAO;;;;gBAAC,UAAA,GAAG;oBAC3C,KAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAI,CAAC,YAAY,CAAC,aAAa,EAAE,GAAG,EAAE,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC;iBAC1F,EAAC,CAAC;aACJ;YAED,KAAI,CAAC,YAAY,GAAG,OAAO,CAAC;YAE5B,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO;aACR;YAED,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,eAAe,CAAC,CAAC,OAAO;;;;YAAC,UAAA,GAAG;;oBACrC,KAAK,GAAG,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC;gBAC9C,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;aACnC,EAAC,CAAC;YAEH,KAAI,CAAC,WAAW,CAAC,OAAO,GAAG,OAAO,CAAC,aAAa,GAAG,SAAS,CAAC,CAAC;SAC/D,EAAC,CAAC;KACJ;;;;;IAED,kDAAW;;;;IAAX,UAAY,OAAsB;QAChC,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;KACvB;;;;IAED,kDAAW;;;IAAX;QACE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;QACxB,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;KAC7B;;;;;;IAEO,kDAAW;;;;;IAAnB,UAAoB,OAAoB;QACtC,IAAI,OAAO,IAAI,IAAI,EAAE;YACnB,OAAO;SACR;;YAEK,IAAI,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC;;YAC5C,IAAI,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC;QAClD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,OAAO,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;QACpD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,OAAO,EAAE,UAAU,EAAE,IAAI,CAAC,OAAO,EAAE,mBAAmB,CAAC,QAAQ,CAAC,CAAC;QACzF,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,OAAO,EAAE,uBAAuB,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,mBAAmB,CAAC,QAAQ,CAAC,CAAC;QACxG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,OAAO,EAAE,oBAAoB,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,mBAAmB,CAAC,QAAQ,CAAC,CAAC;KACtG;;;;;;IAEO,4DAAqB;;;;;IAA7B,UAA8B,KAAwB;QACpD,IAAI,KAAK,IAAI,IAAI,EAAE;YACjB,OAAO,CAAC,KAAK,CAAC,CAAC;SAChB;QACD,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC7B,OAAO,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACrC;QACD,OAAO,KAAK,CAAC,GAAG;;;;QAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAG,CAAC,GAAG,KAAK,GAAA,EAAC,CAAC;KACtC;;gBAhGF,SAAS,SAAC;oBACT,QAAQ,EAAE,uBAAuB;iBAClC;;;;gBA7CC,UAAU,uBA2EG,IAAI;gBAtEjB,SAAS;;;6BA0CR,KAAK;0BASL,KAAK;uBACL,KAAK;uBACL,KAAK;2BAEL,eAAe,SAAC,mBAAmB;;IAgFtC,mCAAC;CAjGD,IAiGC;;;IApFC,+CAAyB;;IACzB,4CAAiC;;IACjC,4CAAiC;;IAEjC,gDACyC;;;;;IAEzC,iDAA4E;;;;;IAC5E,oDAA8C;;;;;IAC9C,uDAKE;;;;;IAEF,iDAAkC;;;;;IAClC,mDAAoC;;;;;IAGxB,iDAA4B;;;;;;;AChF1C;IAIA;KAOiC;;gBAPhC,QAAQ,SAAC;oBACR,YAAY,EAAE,CAAC,4BAA4B,EAAE,mBAAmB,CAAC;oBACjE,OAAO,EAAE;wBACP,YAAY;qBACb;oBACD,OAAO,EAAE,CAAC,4BAA4B,EAAE,mBAAmB,CAAC;iBAC7D;;IAC+B,uBAAC;CAPjC;;;;;;;;;;;;;;"}